<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Universal Expression | .NEXT </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Universal Expression | .NEXT ">
    <meta name="generator" content="docfx 2.48.0.0">
    
    <link rel="shortcut icon" href="../../fav.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../doc_logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="universal-expression">Universal Expression</h1>

<p><a href="../../api/DotNext.Linq.Expressions.UniversalExpression.html">Universal Expression</a> is a powerful tool which allows to use programming language constructs without imitating them using API calls. Compound expressions can be constructed in natural way using operators and constants like in regular code.</p>
<pre><code class="lang-csharp">using DotNext.Linq.Expressions;

UniversalExpression i = 10; //int const
UniversalExpression g = 20; //int const
i += g; //now i is expression tree representing binary addition operation
</code></pre>
<p>Universal expression can be converted into or from <a href="https://docs.microsoft.com/en-us/dotnet/api/system.linq.expressions.expression">Expression class</a>.</p>
<pre><code class="lang-csharp">using DotNext.Linq.Expressions;
using System.Linq.Expressions;

UniversalExpression i = 10;
i = i.Convert&lt;long&gt;() * 20L;
Expression expr = i;
</code></pre>
<p>Properties and methods are accessible using appropriate methods of the universal expression:</p>
<pre><code class="lang-csharp">using DotNext.Linq.Expressions;

UniversalExpression str = &quot;Hello, world&quot;;
var length = str.Property(nameof(string.Length));   //&quot;Hello, world&quot;.Length
</code></pre>
<h1 id="dlr-integration">DLR Integration</h1>
<p>The expression tree can be constructed using <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/using-type-dynamic">dynamic</a> type provided by C# programming language or similar feature in other .NET languages. As a result, expression tree looks like a true language expression or statement without method calls such as <code>Property()</code> or <code>Field()</code> for member access.</p>
<p>This feature converts any dynamic expression into expression tree. The starting point is an instance of <em>UniversalExpression</em> which can be converted into <strong>dynamic</strong> data type. After all necessary manipulations with expression tree it is possible to convert dynamic type into <em>Expression</em> or <em>UniversalExpression</em> type back again.</p>
<pre><code class="lang-csharp">using DotNext.Linq.Expressions;
using System.Linq.Expressions;

dynamic expr = (UniversalExpression)&quot;Hello, world&quot;;
expr = expr.Length;
Expression e = expr;    //equivalent is &quot;Hello, world&quot;.Length
expr = (UniversalExpression)10L;
expr = expr + 42L;
e = expr; //equivalent is 10L + 42L
</code></pre>
<p>Unfortunately, due to limitations of C# programming language, construction of <strong>new</strong> expression or type cast is not available. Delegate invocation expression, method call expression, indexer properties and fields are fully supported.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/sakno/DotNext/blob/gh-pages/docs/features/metaprogramming/universal.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
